{"version":3,"file":"6061.effeb30.js","mappings":"kSAYA,MAeaA,EAAiB,+BAOjBC,EAAsB,mCAOtBC,EAAsB,mCAI5B,MAAMC,UAAqB,EAAAC,OAI9BC,YAAYC,GACRC,QACAC,KAAKC,UAAYH,EAAQI,SACzBF,KAAKG,UAAYL,EAAQM,SACzBJ,KAAKK,SAzCa,0BA0ClBL,KAAKK,SAASL,KAAKC,YAAcT,EAtCtB,mBAII,uBAuCnBc,kBAAkBC,GACd,MAAMC,EAAOD,EAAME,KAAKT,KAAKC,WAC7B,QAAaS,IAATF,EACA,OAEJ,MAAMG,EAAWJ,EAAMI,SAASX,KAAKC,WAC/BW,EAAeD,GAAYA,EAASE,cAAgBF,EAASE,cAAgB,GAExB,UAAvCC,SAASC,KAAKC,QAAQC,eAEtCL,EAAaM,MAAQ,QAEzB,MAAMC,EAAOnB,KAAKC,YAAcT,EAAiB,OAAS,YACpD4B,EAAuB,MAAhBC,EAAQD,KAAeC,EAAQD,WAAaC,EAAQC,aAC3DC,EAAKT,SAASU,cAAc,OAElCxB,KAAKyB,KAAKC,YAAc,GACxB1B,KAAKyB,KAAKE,YAAYJ,GAClBvB,KAAK4B,SACL5B,KAAK4B,QAAQC,WAEjB,MAAMC,EAASV,EAAKA,KAAKU,OAAO,CAC5BC,KAAM,CAAEC,YAAa,iBAYzB,GADAhC,KAAK4B,cAAgBR,EAAKa,QAAQV,EAAIf,EAAM0B,OAAOC,OAAOD,OAAOC,OAAO,CAAEC,SAAS,EAAMC,cAAc,GAAQzB,GAAe,CAAEO,KAAAA,EAAMW,OAAQI,OAAOC,OAAOD,OAAOC,OAAO,GAAIL,GAAS,CAAEQ,SATxKhC,MAAOiC,EAAKzC,KAEzB,MAAMM,EAAWJ,KAAKG,UACtB,IAAKC,MAAAA,OAA2C,EAASA,EAASoC,UAAYpC,EAASoC,QAAQD,GAAM,CACjG,MAAME,QAAgBrC,EAASsC,WAAWH,GAC1CA,QAAYnC,EAASuC,eAAeF,GAExC,OAAOX,EAAOQ,SAASC,EAAKzC,SAG5BS,EAAME,KAAK,aACX,OAGJ,MAAMmC,QAAiB5C,KAAK4B,QAAQiB,KAAKC,WAAW,OACpDvC,EAAMwC,QAAQ,CACVtC,KAAMyB,OAAOC,OAAOD,OAAOC,OAAO,GAAI5B,EAAME,MAAO,CAAE,YAAamC,EAASI,MAAM,KAAK,OAG9FC,UACQjD,KAAK4B,SACL5B,KAAK4B,QAAQC,WAEjB9B,MAAMkD,WAMP,MAAMC,EAAkB,CAC3BC,MAAM,EACNC,UAAW,CAAC5D,EAAgBC,EAAqBC,GACjD2D,eAAgBvD,GAAW,IAAIH,EAAaG,IA0ChD,EAxCkB,CACdwD,GAAI,sCACJJ,gBAAAA,EACAK,KAAM,GACNC,SAAU,OACVC,6BAA8B,CAC1B,CACIC,KAAM,QACNC,gBAAiB,QACjBC,UAAW,CAAC,QAAS,QACrBC,WAAY,CAAC,UAEjB,CACIH,KAAM,aACNC,gBAAiB,aACjBC,UAAW,CAAC,aAAc,aAAc,QACxCC,WAAY,CAAC,aAAc,gBAGnCD,UAAW,CACP,CACIR,UAAW,CAAC5D,GACZkE,KAAM,QACNI,WAAY,CAAC,MAAO,WAAY,SAChCC,KAAM,sBAEV,CACIX,UAAW,CAAC1D,GACZgE,KAAM,aACNI,WAAY,CAAC,MAAO,WAAY,aAChCC,KAAM,sBAEV,CACIX,UAAW,CAAC3D,GACZiE,KAAM,aACNI,WAAY,GACZC,KAAM,wBAQlB,IAAI1C,GACJ,SAAWA,GAWPA,EAAQC,WAPR,WACI,OAAID,EAAQ2C,YAGZ3C,EAAQ2C,UAAY,sCAFT3C,EAAQ2C,WAN3B,CAYG3C,IAAYA,EAAU","sources":["webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/@jupyterlab/vega5-extension/lib/index.js"],"sourcesContent":["/* -----------------------------------------------------------------------------\n| Copyright (c) Jupyter Development Team.\n| Distributed under the terms of the Modified BSD License.\n|----------------------------------------------------------------------------*/\n/**\n * @packageDocumentation\n * @module vega5-extension\n */\nimport { Widget } from '@lumino/widgets';\n/**\n * The CSS class to add to the Vega and Vega-Lite widget.\n */\nconst VEGA_COMMON_CLASS = 'jp-RenderedVegaCommon5';\n/**\n * The CSS class to add to the Vega.\n */\nconst VEGA_CLASS = 'jp-RenderedVega5';\n/**\n * The CSS class to add to the Vega-Lite.\n */\nconst VEGALITE_CLASS = 'jp-RenderedVegaLite';\n/**\n * The MIME type for Vega.\n *\n * #### Notes\n * The version of this follows the major version of Vega.\n */\nexport const VEGA_MIME_TYPE = 'application/vnd.vega.v5+json';\n/**\n * The MIME type for Vega-Lite.\n *\n * #### Notes\n * The version of this follows the major version of Vega-Lite.\n */\nexport const VEGALITE3_MIME_TYPE = 'application/vnd.vegalite.v3+json';\n/**\n * The MIME type for Vega-Lite.\n *\n * #### Notes\n * The version of this follows the major version of Vega-Lite.\n */\nexport const VEGALITE4_MIME_TYPE = 'application/vnd.vegalite.v4+json';\n/**\n * A widget for rendering Vega or Vega-Lite data, for usage with rendermime.\n */\nexport class RenderedVega extends Widget {\n    /**\n     * Create a new widget for rendering Vega/Vega-Lite.\n     */\n    constructor(options) {\n        super();\n        this._mimeType = options.mimeType;\n        this._resolver = options.resolver;\n        this.addClass(VEGA_COMMON_CLASS);\n        this.addClass(this._mimeType === VEGA_MIME_TYPE ? VEGA_CLASS : VEGALITE_CLASS);\n    }\n    /**\n     * Render Vega/Vega-Lite into this widget's node.\n     */\n    async renderModel(model) {\n        const spec = model.data[this._mimeType];\n        if (spec === undefined) {\n            return;\n        }\n        const metadata = model.metadata[this._mimeType];\n        const embedOptions = metadata && metadata.embed_options ? metadata.embed_options : {};\n        // If the JupyterLab theme is dark, render this using a dark Vega theme.\n        let bodyThemeDark = document.body.dataset.jpThemeLight === 'false';\n        if (bodyThemeDark) {\n            embedOptions.theme = 'dark';\n        }\n        const mode = this._mimeType === VEGA_MIME_TYPE ? 'vega' : 'vega-lite';\n        const vega = Private.vega != null ? Private.vega : await Private.ensureVega();\n        const el = document.createElement('div');\n        // clear the output before attaching a chart\n        this.node.textContent = '';\n        this.node.appendChild(el);\n        if (this._result) {\n            this._result.finalize();\n        }\n        const loader = vega.vega.loader({\n            http: { credentials: 'same-origin' }\n        });\n        const sanitize = async (uri, options) => {\n            // Use the resolver for any URIs it wants to handle\n            const resolver = this._resolver;\n            if ((resolver === null || resolver === void 0 ? void 0 : resolver.isLocal) && resolver.isLocal(uri)) {\n                const absPath = await resolver.resolveUrl(uri);\n                uri = await resolver.getDownloadUrl(absPath);\n            }\n            return loader.sanitize(uri, options);\n        };\n        this._result = await vega.default(el, spec, Object.assign(Object.assign({ actions: true, defaultStyle: true }, embedOptions), { mode, loader: Object.assign(Object.assign({}, loader), { sanitize }) }));\n        if (model.data['image/png']) {\n            return;\n        }\n        // Add png representation of vega chart to output\n        const imageURL = await this._result.view.toImageURL('png');\n        model.setData({\n            data: Object.assign(Object.assign({}, model.data), { 'image/png': imageURL.split(',')[1] })\n        });\n    }\n    dispose() {\n        if (this._result) {\n            this._result.finalize();\n        }\n        super.dispose();\n    }\n}\n/**\n * A mime renderer factory for vega data.\n */\nexport const rendererFactory = {\n    safe: true,\n    mimeTypes: [VEGA_MIME_TYPE, VEGALITE3_MIME_TYPE, VEGALITE4_MIME_TYPE],\n    createRenderer: options => new RenderedVega(options)\n};\nconst extension = {\n    id: '@jupyterlab/vega5-extension:factory',\n    rendererFactory,\n    rank: 57,\n    dataType: 'json',\n    documentWidgetFactoryOptions: [\n        {\n            name: 'Vega5',\n            primaryFileType: 'vega5',\n            fileTypes: ['vega5', 'json'],\n            defaultFor: ['vega5']\n        },\n        {\n            name: 'Vega-Lite4',\n            primaryFileType: 'vega-lite4',\n            fileTypes: ['vega-lite3', 'vega-lite4', 'json'],\n            defaultFor: ['vega-lite3', 'vega-lite4']\n        }\n    ],\n    fileTypes: [\n        {\n            mimeTypes: [VEGA_MIME_TYPE],\n            name: 'vega5',\n            extensions: ['.vg', '.vg.json', '.vega'],\n            icon: 'ui-components:vega'\n        },\n        {\n            mimeTypes: [VEGALITE4_MIME_TYPE],\n            name: 'vega-lite4',\n            extensions: ['.vl', '.vl.json', '.vegalite'],\n            icon: 'ui-components:vega'\n        },\n        {\n            mimeTypes: [VEGALITE3_MIME_TYPE],\n            name: 'vega-lite3',\n            extensions: [],\n            icon: 'ui-components:vega'\n        }\n    ]\n};\nexport default extension;\n/**\n * A namespace for private module data.\n */\nvar Private;\n(function (Private) {\n    /**\n     * Lazy-load and cache the vega-embed library\n     */\n    function ensureVega() {\n        if (Private.vegaReady) {\n            return Private.vegaReady;\n        }\n        Private.vegaReady = import('vega-embed');\n        return Private.vegaReady;\n    }\n    Private.ensureVega = ensureVega;\n})(Private || (Private = {}));\n//# sourceMappingURL=index.js.map"],"names":["VEGA_MIME_TYPE","VEGALITE3_MIME_TYPE","VEGALITE4_MIME_TYPE","RenderedVega","Widget","constructor","options","super","this","_mimeType","mimeType","_resolver","resolver","addClass","async","model","spec","data","undefined","metadata","embedOptions","embed_options","document","body","dataset","jpThemeLight","theme","mode","vega","Private","ensureVega","el","createElement","node","textContent","appendChild","_result","finalize","loader","http","credentials","default","Object","assign","actions","defaultStyle","sanitize","uri","isLocal","absPath","resolveUrl","getDownloadUrl","imageURL","view","toImageURL","setData","split","dispose","rendererFactory","safe","mimeTypes","createRenderer","id","rank","dataType","documentWidgetFactoryOptions","name","primaryFileType","fileTypes","defaultFor","extensions","icon","vegaReady"],"sourceRoot":""}